<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="ticketMapper">

<resultMap type="Ticket" id="ticketResultSet">
<!--  TICKET_NO
USER_NO
TICKET_CODE
TICKET_PHONE
TICKET_NAME
TICKET_NOTICE
TICKET_LOCATION
TICKET_DATE
TICKET_STATUS
T_ORIGIN_NAME
T_CHANGE_NAME-->

    <id property="ticketNo" column="TICKET_NO"/>
         <result property="userNo" column="USER_NO"/>
         <result property="price" column="TICKET_CODE"/>
         <result property="ticketPhone" column="TICKET_PHONE"/>
         <result property="ticketTitle" column="TICKET_NAME"/>
         <result property="ticketNotice" column="TICKET_NOTICE"/>
         <result property="ticketLocation" column="TICKET_LOCATION"/>
         <result property="ticketDate" column="TICKET_DATE"/>
         <result property="status" column="TICKET_STATUS"/>
         <result property="originName" column="T_ORIGIN_NAME"/>
         <result property="changeName" column="T_CHANGE_NAME"/>
         <result property="division" column="DIVISION"/>
         

</resultMap>

<!-- 티켓 페이지 - 등록된 티켓 수  -->
<select id="selectListCount"  resultType="_int">
  
  SELECT COUNT(*)
  FROM TICKET
  WHERE TICKET_STATUS='Y'
  
  </select>

<!--  등록된 티켓들 전부 select해오기 -->
  <select id="selectList" resultMap="ticketResultSet">
  
   SELECT *
   FROM TICKET
   WHERE TICKET_STATUS = 'Y'
   ORDER BY TICKET_NO DESC
  
  </select>
  
  <!-- 티켓등록 -->
   <insert id="insertTicket">
      
         INSERT INTO TICKET
         VALUES (SEQ_TICKET.NEXTVAL, #{userNo},#{price},#{ticketPhone},#{ticketTitle},#{ticketNotice}, #{ticketLocation},SYSDATE,DEFAULT,#{originName},#{changeName},#{division})
      </insert>
      
      <!-- 티켓 디테일페이지 조회 -->
      <select id="selectTicket" parameterType = "_int" resultMap = "ticketResultSet">
 
     SELECT *
     FROM TICKET
     WHERE TICKET_NO=#{ticketNo} AND TICKET_STATUS='Y'
 
  </select>
  
   <update id="deleteTicket" parameterType="_int">
		 UPDATE TICKET
      SET TICKET_STATUS = 'N' 
      WHERE TICKET_NO=#{ticketNo}     
	</update> 
	
	<update id="updateTicket" >
		
      SET USER_NO= #{userNo},TICKET_CODE = #{price},TICKET_PHONE = #{ticketPhone},TICKET_NAME=#{ticketTitle},TICKET_NOTICE=#{ticketNotice},
      TICKET_LOCATION=#{ticketLocation},TICKET_STATUS=#{status},T_ORIGIN_NAME=#{originName},T_CHANGE_NAME=#{changeName},DIVISION=#{division}
	 WHERE TICKET_NO=#{ticketNo}
	</update>
  
</mapper>